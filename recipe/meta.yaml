{% set version = "0.1.62" %}
{% set name = "jaxlib" %}

# compute right wheel filename for later
{% set pyver = "cp{}{}".format(PY_VER[0], PY_VER[2]) %}
{% set platform = "manylinux2010_x86_64" %}  # [linux]
{% set platform = "macosx_10_9_x86_64" %}  # [osx]
# {distribution}-{version}(-{build tag})?-{python tag}-{abi tag}-{platform tag}.whl.
{% set fn = "{}-{}-{}-none-{}.whl".format(name, version, pyver, platform) %}

# only use these for the URLS to help the bot
# the urls below have to be explicit for the bot to work
{% set linux_whl = "manylinux2010_x86_64" %}
{% set osx_whl = "macosx_10_9_x86_64" %}

package:
  name: jaxlib
  version: {{ version }}

source:
  fn: wheel.whl

  url: https://pypi.io/packages/cp36/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}-cp36-none-{{ linux_whl }}.whl  # [linux and py==36]
  sha256: 8ae71b54b86f140a840b8c097b015e6fde5c323cc7b2ea716b2707a66370b01e  # [linux and py==36]
  url: https://pypi.io/packages/cp36/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}-cp36-none-{{ osx_whl }}.whl  # [osx and py==36]
  sha256: 9b58be444ef3147913e4117ab34eae80a41a785291380b113ab6a179157de222  # [osx and py==36]

  url: https://pypi.io/packages/cp37/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}-cp37-none-{{ linux_whl }}.whl  # [linux and py==37]
  sha256: 71202f39a02e7286a5371b75fd58f0131514481dc230a0635447f8470359d92c  # [linux and py==37]
  url: https://pypi.io/packages/cp37/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}-cp37-none-{{ osx_whl }}.whl  # [osx and py==37]
  sha256: 58cf9a47e346ca63a3bb6d7ce6b15531fa9ae9bd720cdf99223acb397e1ac26f  # [osx and py==37]

  url: https://pypi.io/packages/cp38/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}-cp38-none-{{ linux_whl }}.whl  # [linux and py==38]
  sha256: 5a615327a4e97b99090bfdf3b24053f9ca8439a3b22d6455450589b7c5e8f95d  # [linux and py==38]
  url: https://pypi.io/packages/cp38/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}-cp38-none-{{ osx_whl }}.whl  # [osx and py==38]
  sha256: 7e7652ce36a23ca2707cf1818db8761583e64238ca29592f630d620d58f973c4  # [osx and py==38]

  url: https://pypi.io/packages/cp39/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}-cp39-none-{{ linux_whl }}.whl  # [linux and py==39]
  sha256: bb878ea37bacd121ac183144998a466aa119859930b787393ea74f7034e0660b  # [linux and py==39]
  url: https://pypi.io/packages/cp39/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}-cp39-none-{{ osx_whl }}.whl  # [osx and py==39]
  sha256: 42d6aff8a7262da6f69b55ecf64847ec741b164e179168f5be6008c23c956edf  # [osx and py==39]

build:
  number: 0
  skip: true  # [win or py2k]
  script:
    - mv wheel.whl {{ fn }}
    - {{ PYTHON }} -m pip install --no-deps -vv {{ fn }}

requirements:
  build:
    - python                                 # [build_platform != target_platform]
    - cross-python_{{ target_platform }}     # [build_platform != target_platform]
  host:
    - python
    - pip
  run:
    - python
    - absl-py
    - numpy >=1.12
    - scipy
    - six
    - python-flatbuffers

test:
  requires:
    - pip
  commands:
    - pip check
  # imports:
    # cannot run the test b/c this is not really manylinux1 GLIBC_2.14
    # Google :-/
    # - jaxlib

about:
  home: http://github.com/google/jax
  license: Apache-2.0
  license_file: LICENSE
  summary: 'Composable transformations of Python+NumPy programs: differentiate, vectorize, JIT to GPU/TPU, and more'

  dev_url: http://github.com/google/jax

extra:
  recipe-maintainers:
    - ericmjl
